---
import "../styles.css";
import DogFacts from "../components/DogFact.astro";

const res = await fetch("https://dogapi.dog/api/v2/facts?limit=5");
const response = await res.json();
const data = response?.data ?? [];
const facts: string[] = data.map((item: any) => item.attributes.body);
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <title>Astro</title>
  </head>
  <body>
    <h1>Dog Facts</h1>
    <DogFacts facts={facts} />
    <button id="cat-fact-button">Get Cat Fact</button>
    <h2 id="cat-fact"></h2>
  </body>
</html>

<script>
  const button = document.getElementById("cat-fact-button");
  const factEl = document.getElementById("cat-fact");

  if (button && factEl) {
    button.addEventListener("click", async () => {
      const res = await fetch("https://catfact.ninja/fact");
      const data = await res.json();
      factEl.innerText = data.fact;
    });
  }
</script>
